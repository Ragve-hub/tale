---
title: Four Up Days and Short for 1% Profit
date: 2020-03-12 14:34:32
---
Cтратегия является разновидностью стратегии Four Down Days. 
Вариант «день с повышением», который использует дни с повышением, а не с понижением, но также обеспечивает выполнение двух дополнительных условий.
Первое условие - четвертый день должен быть огромным (2% и более). Уже через 3 дня рост на 2% на четвертый день будет весьма впечатляющим.

Теоретически такой скачок на четвертый день был бы сильным приглашением для держателей длинных акций забрать часть прибыли со стола на следующее утро, 
тем самым снизив цену. Таким образом, эта стратегия выставляет короткий ордер на закрытие четвертого дня для исполнения на открытии пятого дня.

Второе условие заключается в том, что стратегия завершается, когда она достигает цели прибыли в 1%, и использует лимитный ордер для реализации выхода в течение торгового дня 5.
Если позиция все еще открыта в конце дня 5, стратегия выдает рыночный ордер. для закрытия позиции для исполнения при открытии рынка в 6-й день.

---

# Код

```
using OpenQuant.API;

public class MyStrategy : Strategy
{
	[Parameter("Order quantity (number of contracts to trade)")]
	double Qty = 100;

	[Parameter("Number of consecutive down closes")]
	int ConsClosesCount = 4;

	int count;
	double prevClose;

	public override void OnStrategyStart()
	{
		prevClose = -1;
		count = 0;
	}

	public override void OnBar(Bar bar)
	{
		// we need at least one bar to go by before we do anything
		if (prevClose != -1)
		{
			// if we don't have a position open, increment the count of down days (or reset it to zero)
			if (!HasPosition)
			{
				if (prevClose > bar.Close)
					count++;
				else
					count = 0;

				// if this is the fourth (consClosesCount is equal to 4 by default) down day, 
				// issue a market order to open a long position tomorrow morning, on day 5
				if (count == ConsClosesCount)
					Buy(Qty, "Entry");
			}

			// else if we have a position open, close it now (today is the day after the trade was 
			// entered), so now is actually end of day 6, and the trade will be executed by the market 
			// on open day 7.
			else
				Sell(Qty, "Exit");
		}

		// today's close now becomes the previous close for the down day calculation
		prevClose = bar.Close;
	}
}
```
